---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<BaseLayout title="My Blog" description="Thinking and writing.">
	<Header slot="header" />
	
	<section class="mt-8">
    <h2 class="text-xs font-bold tracking-widest text-zinc-400 dark:text-zinc-500 uppercase mb-8 ml-1">
      Writing
    </h2>
    <ul class="space-y-10">
      {posts.map((post) => (
        <li class="group">
          <a href={`/posts/${post.slug}/`} class="block focus:outline-none">
            <div class="flex flex-col sm:flex-row sm:items-baseline justify-between gap-2 sm:gap-4">
              <h3 class="text-lg md:text-xl font-bold text-zinc-900 dark:text-zinc-100 group-hover:opacity-70 transition-opacity font-serif leading-snug">
                {post.data.title}
              </h3>
              <time datetime={post.data.pubDate.toISOString()} class="text-xs sm:text-sm text-zinc-400 dark:text-zinc-500 font-mono whitespace-nowrap shrink-0">
                {post.data.pubDate.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' })}
              </time>
            </div>
            {post.data.description && (
              <p class="mt-2 text-sm text-zinc-600 dark:text-zinc-400 line-clamp-2 leading-relaxed">
                {post.data.description}
              </p>
            )}
          </a>
        </li>
      ))}
    </ul>
	</section>

	<Footer slot="footer" />
</BaseLayout>
